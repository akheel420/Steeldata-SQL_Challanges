### Challenge_1 -Steve's Car Showroom Solutions

```sql

use steves_car_data;
select * from cars;

select * from sales;

select * from salespersons;
```

**1.What are the details of all cars purchased in the year 2022?**
```sql
select * from cars c
join sales s
on c.car_id=s.car_id
where year(purchase_date)=2022;
```

**2.What is the total number of cars sold by each salesperson?**
```sql
select salesman_id,count(sale_id) 
from sales
group by 1;
```

**3.What is the total revenue generated by each salesperson?**
```sql
select salesman_id,sum(cost_$) revenue from cars c
join sales s
on c.car_id=s.car_id
group by 1;
```

**4.What are the details of the cars sold by each salesperson?**
```sql
select salesman_id,c.car_id,make,type,style,cost_$,purchase_date from cars c
join sales s
on c.car_id=s.car_id
order by salesman_id;
```

**5.What is the total revenue generated by each car type?**
```sql
select type,sum(cost_$) revenue from cars c
join sales s
on c.car_id=s.car_id
group by 1;
```

**6.What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?**
```sql
select s.salesman_id,name,age,city,sale_id,car_id,purchase_date from salespersons sp
join sales s
on sp.salesman_id=s.salesman_id
where name='Emily Wong' and year(purchase_date)=2021;
```

**7.What is the total revenue generated by the sales of hatchback cars?**
```sql
select style,sum(cost_$) revenue from cars c
join sales s
on c.car_id=s.car_id
where style='Hatchback'
group by 1;
```

**8.What is the total revenue generated by the sales of SUV cars in the year 2022?**
```sql
select style,sum(cost_$) revenue from cars c
join sales s
on c.car_id=s.car_id
where style='SUV' and year(purchase_date)=2022
group by 1;
```

**9.What is the name and city of the salesperson who sold the most number of cars in the year 2023?**
```sql
select name,city from
(select s.salesman_id,count(sale_id),name,city from salespersons sp
join sales s
on sp.salesman_id=s.salesman_id
group by 1
order by 2 desc
limit 1) t;```

**10.What is the name and age of the salesperson who generated the highest revenue in the year 2022?**
```sql
select name,age from 
(select s.salesman_id,sum(cost_$),name,age from cars c
join sales s
on c.car_id=s.car_id
join salespersons sp
on s.salesman_id=sp.salesman_id
where year(purchase_date)=2022
group by 1
order by 2 desc
limit 1) t;
```
